<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Historial de Facturas</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ”</text></svg>">
  <link rel="stylesheet" href="../css/historial.css" />
</head>
<body>
  <div class="container">
    <h1>Historial de Facturas</h1>
    
    <input type="text" id="buscarCliente" placeholder="Buscar cliente (mÃ­nimo 3 caracteres)..." />

    <!-- Estado de carga -->
    <div id="estadoCarga" class="loading" style="display: none;">
      <div class="loading-spinner"></div>
      <h3>Buscando facturas...</h3>
      <p>Por favor espere un momento</p>
    </div>

    <!-- Header de resultados con estadÃ­sticas -->
    <div id="resultadosHeader" class="resultados-header" style="display: none;">
      <h2 id="tituloResultados">Facturas encontradas</h2>
      <div class="estadisticas">
        <div class="stat-item">
          <div class="stat-label">Total Facturas</div>
          <div class="stat-value" id="totalFacturas">0</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">Monto Total</div>
          <div class="stat-value currency" id="montoTotal">$0</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">Total Abonado</div>
          <div class="stat-value currency" id="totalAbonado">$0</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">Saldo Pendiente</div>
          <div class="stat-value currency" id="saldoPendiente">$0</div>
        </div>
      </div>
    </div>

    <!-- Resultados de bÃºsqueda -->
    <div id="resultados"></div>

    <!-- Estado vacÃ­o -->
    <div id="estadoVacio" class="empty-state" style="display: none;">
      <div class="empty-icon">ğŸ“„</div>
      <h3>No se encontraron facturas</h3>
      <p>Intenta buscar con un nombre diferente o verifica la ortografÃ­a</p>
    </div>

    <!-- Mensaje inicial -->
    <div id="estadoInicial" class="empty-state">
      <div class="empty-icon">ğŸ”</div>
      <h3>Buscar Historial de Facturas</h3>
      <p>Ingresa el nombre de un cliente para ver su historial de facturas</p>
    </div>
  </div>

  <!-- Modal de ediciÃ³n -->
  <div id="modalEditar" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modalTitulo">Editar Factura</h3>
        <span class="close" onclick="cerrarModal()">&times;</span>
      </div>
      
      <div id="productosContainer">
        <!-- Los productos se cargarÃ¡n aquÃ­ dinÃ¡micamente -->
      </div>
      
      <div class="agregar-producto">
        <h4>â• Agregar Nuevo Producto</h4>
        
        <label for="nuevoProdNombre">Nombre del producto:</label>
        <input type="text" placeholder="Ej: Producto ABC" id="nuevoProdNombre" />
        
        <label for="nuevoProdCantidad">Cantidad:</label>
        <input type="number" placeholder="1" id="nuevoProdCantidad" min="1" value="1" />
        
        <label for="nuevoProdPrecio">Precio Unitario:</label>
        <input type="number" placeholder="0.00" id="nuevoProdPrecio" min="0.01" step="0.01" />
        
        <button class="btn-agregar" onclick="agregarProductoTemp()">
          â• Agregar Producto
        </button>
      </div>
      
      <div class="modal-actions">
        <button class="btn-guardar" id="btnGuardar" onclick="guardarFactura()">
          ğŸ’¾ Guardar Cambios
        </button>
        <button class="btn-cerrar" onclick="cerrarModal()">
          âŒ Cerrar
        </button>
      </div>
    </div>
  </div>

  <!-- Scripts necesarios -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

  <!-- Script principal -->
  <script>
    // Cerrar modal al hacer clic fuera de Ã©l
    window.onclick = function(event) {
      const modal = document.getElementById('modalEditar');
      if (event.target === modal) {
        cerrarModal();
      }
    }

    // FunciÃ³n para cerrar modal
    function cerrarModal() {
      document.getElementById('modalEditar').style.display = 'none';
    }
  </script>
  
  <script src="../js/historial.js"></script>
</body>
</html>